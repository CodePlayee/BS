{"queryPath":"/index.js","absPath":"/Users/gaozhen/Documents/BS/index.js","realPath":"/index.js","type":"script","source":"const Event = require('bcore/event');\n// const $ = require('jquery');\n// const _ = require('lodash');\nconst { genMainStream, genBranches } = require('./src/main')\nconst { drawPt, drawSvgBorder } = require('./src/draw')\nconst rawData = require('./src/data')\n\nclass Rivers extends Event {\n  constructor(container, config) {\n    super();\n    this.container = container;\n    this.config = config;\n    this.apis = config.apis;\n    this.data = [];\n    this.init();\n    this.rendered = false;\n\n  }\n\n  init() {\n    const width = this.container.clientWidth;\n    const height = this.container.clientHeight;\n    let mainstream //顶级干流\n    let level1Branches\n    // let lenRatio //原始信息中数值与图面线符号长度的比值（例如数据中的 1 对应图面 100px）\n\n    const svg = document.createElementNS('http://www.w3.org/2000/svg', 'svg');\n\n    svg.setAttribute(\"style\", `width:${width}; height:${height}; z-index:1;`);\n    svg.setAttribute(\"viewBox\", `0 0 ${width} ${height}`);\n    this.container.appendChild && this.container.appendChild(svg)\n\n    drawSvgBorder(width, height)\n\n    const msPadding = 50 //顶级干流起止点与绘图区域边框之间的间隙\n    mainstream = genMainStream(svg, msPadding, rawData.level0)\n    mainstream.draw(mainstream.bezierPts, 'mainstream', undefined, 4, undefined)\n\n    level1Branches = genBranches(mainstream, rawData.level1)\n    mainstream.setBranches(level1Branches)\n\n    level1Branches.forEach((branch, idx) => branch.draw(branch.bezierPts, `level1-${idx}`, undefined, 2, undefined))\n\n    console.log(mainstream)\n\n    // 用来展示点击详情\n    // const infoDiv = document.createElement('div');\n    // const divWidth = width * 0.3;\n\n    // infoDiv.style.cssText = `background:gray; opacity:0.5; color:yellow; \n    // width:${divWidth}px; position:fixed; left:10px; top:10px; \n    // padding:5px;\n    // border:3px solid black; z-index:1;`;\n    // this.container.appendChild(infoDiv);\n\n  }\n\n  // allow the camera to orbit around a target\n  loop() {\n    requestAnimationFrame(this.loop.bind(this));\n  }\n\n  // render or setData\n  render(data) {\n    if (this.rendered) return;\n\n    this.data = data;\n    // this.loop();\n    this.rendered = true;\n  }\n\n  // 用户在界面修改了配置\n  updateOptions(config) {\n    this.rendered = false;\n\n    // this.render(this.data);\n\n  }\n\n  // destroy\n  destroy() {\n    // this.container.removeChild(this.canvas);\n  }\n}\n\nmodule.exports = Rivers;\n\n","code":"'use strict';\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar Event = require('bcore/event');\n\nvar _require = require('./src/main'),\n    genMainStream = _require.genMainStream,\n    genBranches = _require.genBranches;\n\nvar _require2 = require('./src/draw'),\n    drawPt = _require2.drawPt,\n    drawSvgBorder = _require2.drawSvgBorder;\n\nvar rawData = require('./src/data');\n\nvar Rivers = function (_Event) {\n  _inherits(Rivers, _Event);\n\n  function Rivers(container, config) {\n    _classCallCheck(this, Rivers);\n\n    var _this = _possibleConstructorReturn(this, (Rivers.__proto__ || Object.getPrototypeOf(Rivers)).call(this));\n\n    _this.container = container;\n    _this.config = config;\n    _this.apis = config.apis;\n    _this.data = [];\n    _this.init();\n    _this.rendered = false;\n\n    return _this;\n  }\n\n  _createClass(Rivers, [{\n    key: 'init',\n    value: function init() {\n      var width = this.container.clientWidth;\n      var height = this.container.clientHeight;\n      var mainstream = void 0;\n      var level1Branches = void 0;\n\n\n      var svg = document.createElementNS('http://www.w3.org/2000/svg', 'svg');\n\n      svg.setAttribute(\"style\", 'width:' + width + '; height:' + height + '; z-index:1;');\n      svg.setAttribute(\"viewBox\", '0 0 ' + width + ' ' + height);\n      this.container.appendChild && this.container.appendChild(svg);\n\n      drawSvgBorder(width, height);\n\n      var msPadding = 50;\n      mainstream = genMainStream(svg, msPadding, rawData.level0);\n      mainstream.draw(mainstream.bezierPts, 'mainstream', undefined, 4, undefined);\n\n      level1Branches = genBranches(mainstream, rawData.level1);\n      mainstream.setBranches(level1Branches);\n\n      level1Branches.forEach(function (branch, idx) {\n        return branch.draw(branch.bezierPts, 'level1-' + idx, undefined, 2, undefined);\n      });\n\n      console.log(mainstream);\n    }\n  }, {\n    key: 'loop',\n    value: function loop() {\n      requestAnimationFrame(this.loop.bind(this));\n    }\n  }, {\n    key: 'render',\n    value: function render(data) {\n      if (this.rendered) return;\n\n      this.data = data;\n\n      this.rendered = true;\n    }\n  }, {\n    key: 'updateOptions',\n    value: function updateOptions(config) {\n      this.rendered = false;\n    }\n  }, {\n    key: 'destroy',\n    value: function destroy() {}\n  }]);\n\n  return Rivers;\n}(Event);\n\nmodule.exports = Rivers;","codeWraped":"Cube(\"/index.js\", [\"/node_modules/bcore/event.js\", \"/src/main.js\", \"/src/draw.js\", \"/src/data.js\"], function (module, exports, require, load, process, global) {\n\n  var _createClass = function () {function defineProperties(target, props) {for (var i = 0; i < props.length; i++) {var descriptor = props[i];descriptor.enumerable = descriptor.enumerable || false;descriptor.configurable = true;if (\"value\" in descriptor) descriptor.writable = true;Object.defineProperty(target, descriptor.key, descriptor);}}return function (Constructor, protoProps, staticProps) {if (protoProps) defineProperties(Constructor.prototype, protoProps);if (staticProps) defineProperties(Constructor, staticProps);return Constructor;};}();\n\n  function _classCallCheck(instance, Constructor) {if (!(instance instanceof Constructor)) {throw new TypeError(\"Cannot call a class as a function\");}}\n\n  function _possibleConstructorReturn(self, call) {if (!self) {throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");}return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self;}\n\n  function _inherits(subClass, superClass) {if (typeof superClass !== \"function\" && superClass !== null) {throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass);}subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } });if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass;}\n\n  var Event = require('/node_modules/bcore/event.js');\n\n  var _require = require('/src/main.js'),\n  genMainStream = _require.genMainStream,\n  genBranches = _require.genBranches;\n\n  var _require2 = require('/src/draw.js'),\n  drawPt = _require2.drawPt,\n  drawSvgBorder = _require2.drawSvgBorder;\n\n  var rawData = require('/src/data.js');\n\n  var Rivers = function (_Event) {\n    _inherits(Rivers, _Event);\n\n    function Rivers(container, config) {\n      _classCallCheck(this, Rivers);\n\n      var _this = _possibleConstructorReturn(this, (Rivers.__proto__ || Object.getPrototypeOf(Rivers)).call(this));\n\n      _this.container = container;\n      _this.config = config;\n      _this.apis = config.apis;\n      _this.data = [];\n      _this.init();\n      _this.rendered = false;\n\n      return _this;\n    }\n\n    _createClass(Rivers, [{\n      key: 'init',\n      value: function init() {\n        var width = this.container.clientWidth;\n        var height = this.container.clientHeight;\n        var mainstream = void 0;\n        var level1Branches = void 0;\n\n\n        var svg = document.createElementNS('http://www.w3.org/2000/svg', 'svg');\n\n        svg.setAttribute(\"style\", 'width:' + width + '; height:' + height + '; z-index:1;');\n        svg.setAttribute(\"viewBox\", '0 0 ' + width + ' ' + height);\n        this.container.appendChild && this.container.appendChild(svg);\n\n        drawSvgBorder(width, height);\n\n        var msPadding = 50;\n        mainstream = genMainStream(svg, msPadding, rawData.level0);\n        mainstream.draw(mainstream.bezierPts, 'mainstream', undefined, 4, undefined);\n\n        level1Branches = genBranches(mainstream, rawData.level1);\n        mainstream.setBranches(level1Branches);\n\n        level1Branches.forEach(function (branch, idx) {\n          return branch.draw(branch.bezierPts, 'level1-' + idx, undefined, 2, undefined);\n        });\n\n        console.log(mainstream);\n      } },\n    {\n      key: 'loop',\n      value: function loop() {\n        requestAnimationFrame(this.loop.bind(this));\n      } },\n    {\n      key: 'render',\n      value: function render(data) {\n        if (this.rendered) return;\n\n        this.data = data;\n\n        this.rendered = true;\n      } },\n    {\n      key: 'updateOptions',\n      value: function updateOptions(config) {\n        this.rendered = false;\n      } },\n    {\n      key: 'destroy',\n      value: function destroy() {} }]);\n\n\n    return Rivers;\n  }(Event);\n\n  module.exports = Rivers;return module.exports;});","sourceMap":null,"modifyTime":1583311456164,"mime":"application/javascript","wrap":true,"skip":false,"compress":false,"ext":".js","targetExt":".js","loads":[],"originalLoads":[],"requires":["/node_modules/bcore/event.js","/src/main.js","/src/draw.js","/src/data.js"],"requiresOrigin":["/node_modules/bcore/event.js","/src/main.js","/src/draw.js","/src/data.js"],"debugInfo":[],"requiresArgsRefer":[{"type":"StringLiteral","start":1494,"end":1507,"loc":{"start":{"line":11,"column":20},"end":{"line":11,"column":33}},"extra":{"rawValue":"bcore/event","raw":"'bcore/event'"},"value":"/node_modules/bcore/event.js"},{"type":"StringLiteral","start":1534,"end":1546,"loc":{"start":{"line":13,"column":23},"end":{"line":13,"column":35}},"extra":{"rawValue":"./src/main","raw":"'./src/main'"},"value":"/src/main.js"},{"type":"StringLiteral","start":1658,"end":1670,"loc":{"start":{"line":17,"column":24},"end":{"line":17,"column":36}},"extra":{"rawValue":"./src/draw","raw":"'./src/draw'"},"value":"/src/draw.js"},{"type":"StringLiteral","start":1772,"end":1784,"loc":{"start":{"line":21,"column":22},"end":{"line":21,"column":34}},"extra":{"rawValue":"./src/data","raw":"'./src/data'"},"value":"/src/data.js"}]}